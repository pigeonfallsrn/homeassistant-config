
## Inovelli Config Button Hold Not Working - Root Cause & Fix

**Problem:** Config button press worked for fan speed cycling, but hold (to turn off) was not detected.

**Root Cause:** Button delay parameter was set to 0 (instant). With delay=0, the switch fires immediately on press and cannot distinguish between press, hold, double-tap, or triple-tap gestures.

**Fix:** Set button delay to ≥1 (100ms minimum):
```yaml
entity: number.<device>_button_delay
value: 1
```

**Key Insight:** This applies to ALL Inovelli multi-tap/hold detection, not just paddle - includes config button (button_3 on main, button_6 on aux).

## Inovelli Config Button Event Reference (ZHA)

| Button | Main Switch | Aux Switch |
|--------|-------------|------------|
| Config press | button_3_press | button_6_press |
| Config hold | button_3_hold | button_6_hold |
| Config double | button_3_double | button_6_double |
| Config triple | button_3_triple | button_6_triple |

All use cluster_id: 64561

## Working Fan Speed Automation Pattern

Config button controls separate Inovelli fan (VZM36):
- 1x press → 33% (low)
- 2x press → 66% (medium)
- 3x press → 100% (high)
- Hold → off

Automation: `automation.kitchen_lounge_aux_switch_controls_hue_ceiling`
- 16:27: 1st Floor Bathroom Inovelli automation was missing (ghost entity in registry). Created blueprint automation targeting light.1st_floor_bathroom Hue group with brightness_pct:100 on up-paddle.
- 16:27: Dumb light switches (direct load control) should have button_delay=0 for instant response - no need for multi-tap scene detection. Applies to: Kitchen Ceiling Cans, Under Cabinet, Bar Pendants.
- 16:27: Blueprint Inovelli automations calling light.turn_on without brightness_pct will restore last dimmed state. Always include brightness_pct:100 in up-paddle action to ensure full brightness on single press.
- 16:33: Inovelli VZM31-SN sends 3 zha_events per button press: level cluster (on/off) + scene cluster (button_X_press). Blueprint triggers on all but only matches scene commands. mode:single + max_exceeded:silent prevents actual duplicate actions. 'Double-fire' warnings are phantom triggers - harmless noise, not real duplicates.
- 16:45: Config button best practices: 1) Fan control (1x/2x/3x=speeds, hold=off), 2) Robot vacuum trigger, 3) Scene cycling, 4) Secondary device toggle. EP3 supports Zigbee binding for hub-independent control.
- 16:45: Kitchen dumb switch flicker/slow fix: Ceiling Cans had on_off_transition_time=5 (5 sec!), Bar Pendants had min_dim=1 causing turn-off flicker. Fix: transition_time=0 for instant, min_dim=15+ to avoid LED driver flicker zone.
- 16:50: Inovelli dumb switch slow on/off fix: on_off_transition_time controls Zigbee commands, but LOCAL_RAMP_RATE controls physical paddle. Ceiling Cans had local_ramp_rate_on_to_off=102 (102 sec!). Set all local_ramp_rate params to 0 for instant response.
- 16:50: Inovelli LED flicker at turn-off: caused by minimum_load_dimming_level too low. LED drivers flicker in low-dim zone. Bar Pendants fixed by raising min_dim from 1 to 25. Start at 15, increase if still flickering.
- 16:54: Inovelli dumb switch slow on/off fix: on_off_transition_time controls Zigbee commands, but LOCAL_RAMP_RATE controls physical paddle. Ceiling Cans had local_ramp_rate_on_to_off=102 (102 sec!). Set all local_ramp_rate params to 0 for instant response.
- 16:54: Inovelli LED flicker at turn-off: caused by minimum_load_dimming_level too low. LED drivers flicker in low-dim zone. Bar Pendants fixed by raising min_dim from 1 to 25. Start at 15, increase if still flickering.
- 16:54: fxlt blueprint hold actions fire once per hold - use brightness_step_pct for single 10% step. For smooth continuous dimming, need repeat loop with input_boolean controlled by hold/release events. Ratoka blueprint (github.com/Ratoka/home-assistant-hue-inovelli-blueprints) provides this plus auto scene cycling.
- 16:58: Git "confused by unstable object source data" fix: run git gc --prune=now before commit. Caused by zigbee.db changing during git add. Prevention: add zigbee.db* to .gitignore or reset before AND after git add -A. Always use single quotes in ZSH commit messages to avoid ! expansion.
- 17:03: AL cleanup: removing entry_room_hue_color_lamp from Living Spaces (duplicate - has dedicated instance), fixing separate_turn_on_commands on Entry Room Lamp Adaptive
- 17:23: fxlt blueprint fix: added event_data.device_id filter to trigger - prevents firing on all 49 ZHA device events, now only fires for specific switch
- 19:21: Session complete: AL deduplication + fxlt blueprint event_data filter fix. Inovelli double-fires eliminated (132x/hr → 0)
- 19:26: Area cleanup: deleted empty sun_room area, keeping living_room_lounge as canonical name for that space
