- 09:01: Created garage_quick_open.yaml with north door open/close notifications. Removed approaching_home and michelle arrival from notifications_system.yaml. Installed HAC v6.0 with pkg/ids/edit/table commands.
- 09:16: HAC v6.1 deployed. Cleaned garage automations - removed duplicate notification handlers from garage_lighting_automation.yaml, kept lights on/off + left-open reminder. garage_quick_open.yaml handles north door open/close notifications. 5 orphan automations disabled.

## Recovery Tips
- **HA Green hung** (Core unresponsive, SSH refused, but ping works): Use UniFi Network console to power cycle switch port 8 instead of physical unplug. Faster recovery.

- 15:45: Fixed double-trigger issue in kitchen_lounge_lamp_adaptive_control and entry_room_lamp_adaptive_lux_control. Added 5-second debounce condition using last_triggered timestamp. Reloaded automations. Fixed dad_bedtime_mode unavailable state (input_boolean reload).
- 16:05: Fixed double-trigger root cause - changed motion triggers from individual sensors to combined binary_sensor.kitchen_lounge_motion and binary_sensor.entry_room_motion. This eliminates the race condition where two sensors fired simultaneously.
- 17:02: MCP OAuth status 2026-01-22: HA creates tokens successfully, Claude.ai callback fails to complete handshake. Beta bug on Anthropic side. Infrastructure ready - will work when fixed. Pivot to exposure audit and WAF rules.
- 17:56: MCP CONNECTED 2026-01-22. Claude Desktop working via mcp-remote + Bearer token. Config: cmd.exe /C npx -y mcp-remote. Required: Node.js install + mkdir npm folder. 23 tools available. Claude.ai web OAuth still broken (beta bug) but Desktop works.
- 18:24: MCP SETUP COMPLETE 2026-01-22: Claude Desktop connected via mcp-remote+Bearer token. Claude.ai web OAuth blocked (Anthropic beta bug). 499 entities exposed, need to hide ~70 more (person/location/status sensors). TODO: rotate token, run jq command to hide sensitive entities, add Cloudflare WAF rule. Hybrid workflow: HAC=context+YAML, MCP=realtime queries+actions.
- 18:25: MCP SETUP 2026-01-22: Claude Desktop connected (mcp-remote+Bearer). Claude.ai OAuth blocked (Anthropic bug). 499 entities exposed, ~70 sensitive to hide. TODO: rotate token, jq hide entities, Cloudflare WAF. See mcp_integration_handoff.md for full details.
- 18:53: HAC v7.0 deployed - secret gist, auto-backup, safe sed, privacy sanitization
- 20:12: Fixed apply_context_on_time_change double-fire by removing redundant sun/time triggers (sensor.time_context already handles those transitions). Cleaned up .backup files from packages dir.
- 20:15: Fixed apply_context_on_time_change double-fire by removing redundant sun/time triggers (sensor.time_context already handles those transitions). Cleaned up .backup files from packages dir.
- 20:20: HAC v7.1 deployed: audit, sed --preview, diff, restore, check, hygiene. Fixed context_apply_on_time_change double-fire. Monitor 21:00 for calendar_refresh_school_in_session_now.
- 21:13: HAC v7.2: Python sanitizer with entity ID preservation. Sanitizes zone names, addresses, emails, IPs. Preserves snake_case entity IDs for debugging.
- 22:00: Fixed garage lights staying on - OFF trigger now fires after 6min in any state (removed 'to: off'). Migrated garage door notifications to native alert: integration with input_datetime snooze (survives restarts). Added South door quick close option. Reduced close notification delay 5sâ†’2s. Added arrival lights automation (driveway + garage at night when approaching).
- 22:53: Adaptive lighting best practices: 1) Use lux-based triggers not sun.sun for precision, 2) Add activity boost automation to restore brightness when motion detected while dimmed, 3) Use consistent motion sensors (aggregated) for both on and timeout triggers, 4) Use platform:time with sensor for reliable hard-off (not template string match), 5) Remove redundant per-room everyone-left automations when global exists, 6) Tune timeouts per room type: transition spaces 5/10min, active areas 8/20min, relaxation areas 15/45min, 7) Add brightness gate (above 50) on dim automations to prevent re-dimming, 8) Keep lux sensors in motion_aggregation.yaml for centralized management.
