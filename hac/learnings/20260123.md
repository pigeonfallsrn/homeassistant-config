- 09:33: Consolidated 2nd floor lighting: Replaced 3 automations (night_path_upstairs_hallway, night_path_2nd_floor_bathroom, morning_wake_upstairs_hallway) with 2 clean automations: upstairs_hallway_motion_lighting (all time contexts, deep red at night, adaptive handoff day) and 2nd_floor_bathroom_night_lighting (night only, triggered by hallway P1, shower-safe 15min timeout). Disabled morning_wake_master_bedroom in UI. Lines 505 and 570 in occupancy_system.yaml.

## Family Activities System - Built 2026-01-23

### New Package: `packages/family_activities.yaml`

**Purpose:** Context-aware activity tracking for lighting and automation decisions using calendar + location fusion.

**Components Created:**

#### Zones
- `zone.bagc_gymnastics` - Alaina's gymnastics (20256 W Mill Rd, Galesville, WI)

#### Grade Tracking (auto-increments Aug 15)
- `input_number.ella_grade` - Currently 6
- `input_number.alaina_grade` - Currently 8
- `input_number.jarrett_grade` - Placeholder (3)
- `input_number.owen_grade` - Placeholder (1)

#### Activity Detection (Calendar + Location Fusion)
- `binary_sensor.ella_at_activity` - True when: not home + not school + any calendar active
- `binary_sensor.alaina_at_activity` - True when: at BAGC zone OR (not home + not school + calendar active)

#### Arrival & Time Tracking
- `input_datetime.ella_last_arrived_home` / `alaina_last_arrived_home`
- `sensor.ella_minutes_since_home` / `alaina_minutes_since_home`

#### Late Activity Detection
- `binary_sensor.ella_had_late_activity` - Had activity AND arrived home after 7pm
- `binary_sensor.alaina_had_late_activity`

#### Wind-down Logic
- `binary_sensor.ella_winddown_active` / `alaina_winddown_active`
- Logic: School tomorrow + at home + (9pm OR 90min after late arrival)
- Override: `input_boolean.ella_winddown_override` / `alaina_winddown_override`

#### Automations
- `family_ella_arrived_home` / `family_alaina_arrived_home` - Track arrival times
- `family_ella_left_for_activity` / `family_alaina_left_for_activity` - Set activity flags
- `family_daily_reset` - Clear flags at 4am
- `family_increment_grades` - Auto-increment grades Aug 15

### Calendar Entities Used
**Ella:**
- `calendar.12s_1` - Tenacity 12s-1 volleyball
- `calendar.whitehall_6th_grade_volleyball` - School volleyball
- `calendar.6th_grade_girls_basketball` - School basketball (ended)

**Alaina:**
- `calendar.14s_2` - Tenacity 14s-2 (practice only, no games)
- `calendar.whitehall_middle_school_volleyball_calendar` - School volleyball
- `calendar.bagc_maga_team_1_2_calendar` - BAGC gymnastics (final season)

### Key Design Decisions
1. **Calendar + Location Fusion** - Combines "not home" + "calendar event active" for reliable activity detection even without precise GPS zones for every venue
2. **Late Activity = 7pm+** - Arriving home after 7pm with activity flag triggers 90-min delayed wind-down instead of fixed 9pm
3. **Lights only (silent)** - Wind-down triggers lighting changes without phone notifications
4. **Grade-based logic** - Age divisions (12U, 14U) and school levels (elementary, middle, high) derived from grade

### Future Enhancements (Phase 2)
- [ ] Connect wind-down sensors to kids_bedroom_automation.yaml
- [ ] Add WAYA softball calendars when season starts
- [ ] Seasonal sport active flags
- [ ] Dashboard card for family activities visibility

### Notes
- Alaina's Tenacity 14s-2: Practice only, no tournaments (still triggers activity detection)
- Alaina's BAGC gymnastics: Final season
- Alaina's softball: Last year of 14U
- Ella's softball: 12U this year, then 2 years of 14U
