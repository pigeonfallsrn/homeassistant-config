# Session Learnings - 2026-02-19

## Inovelli VZM31-SN Smart Bulb Mode - Deep Debugging

### Entry Room Ceiling - FIXED
- Reconfigure device (re-interviews Zigbee clusters) + smart_bulb_mode toggle + air gap = working
- Now sends button_2_press/button_1_press correctly, fxlt blueprint automation functional

### 1st Floor Bathroom - STUBBORN (factory reset needed)
- smart_bulb_mode reads Bool.true from cluster 0xfc31 (attr 0x0034) but firmware ignores it
- Direct cluster write via Manage Zigbee Clusters confirmed successful but relay still toggles
- Toggle OFF→ON at cluster level (force state transition) did not help
- Output mode was set to "OnOff" - changed to "Dimmer" but still no effect
- "Disable relay click in on off" toggle also ineffective
- Firmware in corrupted state - acknowledges writes but doesn't honor them
- **Next step: Factory reset (hold config button 20+ sec until LED red), then reconfigure from clean state**

### Key Learnings
- ZHA Reconfigure forces cluster re-interview, can help with stale params
- Manage Zigbee Clusters → InovelliVZM31SNCluster (Endpoint 1, 0xfc31) allows direct attribute read/write
- smart_bulb_mode = attribute 0x0034 (decimal 52), Bool type
- Output mode parameter (OnOff vs Dimmer) exists separately from smart_bulb_mode - check both
- "Disable relay click in on off" is additional relay control param
- Some switches get into corrupted firmware state where params read correctly but aren't honored - factory reset is the nuclear fix
- Reconfigure + toggle + air gap fixed Entry Room but not 1st Floor Bathroom - switch-specific corruption
- Scene events (button_X_press) can work even when smart_bulb_mode is broken - they're independent features
